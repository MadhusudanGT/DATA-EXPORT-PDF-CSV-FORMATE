!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("html2canvas"),require("xlsx"),require("html2pdf.js")):"function"==typeof define&&define.amd?define("ngx-export-as",["exports","@angular/core","rxjs","html2canvas","xlsx","html2pdf.js"],t):t((e=e||self)["ngx-export-as"]={},e.ng.core,e.rxjs,e.html2canvas,e.xlsx,e.html2pdf)}(this,(function(e,t,n,o,r,a){"use strict";o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,window.html2canvas=o;var l=function(){function e(){}return e.prototype.get=function(e){var t="get"+e.type.toUpperCase();return this[t]?this[t](e):n.Observable.create((function(e){e.error("Export type is not supported.")}))},e.prototype.save=function(e,t){return e.download=!0,e.fileName=t+"."+e.type,this.get(e)},e.prototype.contentToBlob=function(e){return n.Observable.create((function(t){for(var n=e.split(","),o=n[0].match(/:(.*?);/)[1],r=atob(n[1]),a=r.length,l=new Uint8Array(a);a--;)l[a]=r.charCodeAt(a);t.next(new Blob([l],{type:o})),t.complete()}))},e.prototype.removeFileTypeFromBase64=function(e){return/^data:[^]*;base64,/g[Symbol.replace](e,"")},e.prototype.addFileTypeToBase64=function(e,t){return"data:"+t+";base64,"+e},e.prototype.downloadFromDataURL=function(e,t){var n=this;this.contentToBlob(t).subscribe((function(t){n.downloadFromBlob(t,e)}))},e.prototype.downloadFromBlob=function(e,t){var n=window.URL.createObjectURL(e);if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,t);else{var o=document.createElement("a");o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.href=n,o.click(),document.body.removeChild(o)}},e.prototype.getPDF=function(e){var t=this;return n.Observable.create((function(n){e.options||(e.options={}),e.options.filename=e.fileName;var o=document.getElementById(e.elementIdOrContent),r=a().set(e.options).from(o||e.elementIdOrContent),l=e.download,i=e.options.pdfCallbackFn;l?(i?t.applyPdfCallbackFn(r,i).save():r.save(),n.next(),n.complete()):i?t.applyPdfCallbackFn(r,i).outputPdf("datauristring").then((function(e){n.next(e),n.complete()})):r.outputPdf("datauristring").then((function(e){n.next(e),n.complete()}))}))},e.prototype.applyPdfCallbackFn=function(e,t){return e.toPdf().get("pdf").then((function(e){t(e)}))},e.prototype.getPNG=function(e){var t=this;return n.Observable.create((function(n){var r=document.getElementById(e.elementIdOrContent);o(r,e.options).then((function(o){var r=o.toDataURL("image/PNG");"png"===e.type&&e.download?(t.downloadFromDataURL(e.fileName,r),n.next()):n.next(r),n.complete()}),(function(e){n.error(e)}))}))},e.prototype.getCSV=function(e){var t=this;return n.Observable.create((function(n){for(var o=[],r=document.getElementById(e.elementIdOrContent).querySelectorAll("table tr"),a=0;a<r.length;a++){for(var l=[],i=r[a].querySelectorAll("td, th"),s=0;s<i.length;s++){var c=i[s];l.push(c.innerText)}o.push(l.join(","))}var d="data:text/csv;base64,"+t.btoa(o.join("\n"));e.download?(t.downloadFromDataURL(e.fileName,d),n.next()):n.next(d),n.complete()}))},e.prototype.getTXT=function(e){var t=e.fileName.split(".");return e.fileName=t[0]+".txt",this.getCSV(e)},e.prototype.getXLS=function(e){var t=this;return n.Observable.create((function(n){var o=document.getElementById(e.elementIdOrContent),a=r.utils.table_to_sheet(o,e.options),l=r.utils.book_new();r.utils.book_append_sheet(l,a,e.fileName);var i="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+r.write(l,{type:"base64"});e.download?(t.downloadFromDataURL(e.fileName,i),n.next()):n.next(i),n.complete()}))},e.prototype.getXLSX=function(e){return this.getXLS(e)},e.prototype.getJSON=function(e){var t=this;return n.Observable.create((function(n){for(var o=[],r=[],a=document.getElementById(e.elementIdOrContent),l=0;l<a.rows[0].cells.length;l++)r[l]=a.rows[0].cells[l].innerHTML.toLowerCase().replace(/ /gi,"");for(var i=1;i<a.rows.length;i++){for(var s=a.rows[i],c={},d=0;d<s.cells.length;d++)c[r[d]]=s.cells[d].innerHTML;o.push(c)}var p=JSON.stringify(o),u="data:text/json;base64,"+t.btoa(p);e.download?(t.downloadFromDataURL(e.fileName,u),n.next()):n.next(o),n.complete()}))},e.prototype.getXML=function(e){var t=this;return n.Observable.create((function(n){for(var o='<?xml version="1.0" encoding="UTF-8"?><Root><Classes>',r=document.getElementById(e.elementIdOrContent).getElementsByTagName("tr"),a=0;a<r.length;a++){var l=r[a];if(l.cells.length>0){o+='<Class name="'+l.cells[0].textContent+'">\n';for(var i=1;i<l.cells.length;++i)o+="\t<data>"+l.cells[i].textContent+"</data>\n";o+="</Class>\n"}}o+="</Classes></Root>";var s="data:text/xml;base64,"+t.btoa(o);e.download?(t.downloadFromDataURL(e.fileName,s),n.next()):n.next(s),n.complete()}))},e.prototype.btoa=function(e){return btoa(unescape(encodeURIComponent(e)))},e.ɵfac=function(t){return new(t||e)},e.ɵprov=t.ɵɵdefineInjectable({token:e,factory:e.ɵfac}),e}(),i=function(){function e(){}return e.ɵmod=t.ɵɵdefineNgModule({type:e}),e.ɵinj=t.ɵɵdefineInjector({factory:function(t){return new(t||e)},providers:[l]}),e}();e.ExportAsModule=i,e.ExportAsService=l,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-export-as.umd.min.js.map